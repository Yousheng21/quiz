{"ast":null,"code":"import React from \"react\";\nimport saveToLocalStorage, { store } from \"../store\";\nimport axios from \"axios\";\nimport { refreshHistory, setHistory } from \"../reducers/appReducer\";\nexport const startHistory = async () => {\n  try {\n    const id = store.getState().user.currentUser.id;\n    const response = await axios.post('http://localhost:5000/history/response', {\n      id\n    });\n    let amount = counterQuizzes(response.data.response);\n    store.dispatch(setHistory(response.data.response, amount));\n    saveToLocalStorage('history', response.data.response);\n    saveToLocalStorage('amount', amount);\n  } catch (e) {\n    console.log(e.response);\n  }\n};\n\nfunction counterQuizzes(history) {\n  const userId = store.getState().user.id;\n  let amount = {\n    history: 0,\n    biology: 0,\n    geography: 0,\n    mixed: 0\n  };\n  history.forEach(item => {\n    if (item.userId === userId) {\n      switch (item.kind) {\n        case 'history':\n          amount.history++;\n          break;\n\n        case 'biology':\n          amount.biology++;\n          break;\n\n        case 'geography':\n          amount.geography++;\n          break;\n\n        case 'mixed':\n          amount.mixed++;\n          break;\n      }\n    }\n  });\n  return amount;\n}\n\nexport const refresh = () => {\n  let history = store.getState().app.history;\n  if (history.length === 0) store.dispatch(refreshHistory());\n};","map":{"version":3,"sources":["F:/Myproject/node1/client/src/actions/history.js"],"names":["React","saveToLocalStorage","store","axios","refreshHistory","setHistory","startHistory","id","getState","user","currentUser","response","post","amount","counterQuizzes","data","dispatch","e","console","log","history","userId","biology","geography","mixed","forEach","item","kind","refresh","app","length"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,kBAAP,IAA4BC,KAA5B,QAAwC,UAAxC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAQC,cAAR,EAAwBC,UAAxB,QAAyC,wBAAzC;AAGA,OAAO,MAAOC,YAAY,GAAG,YAAW;AAEpC,MAAI;AACA,UAAMC,EAAE,GAAGL,KAAK,CAACM,QAAN,GAAiBC,IAAjB,CAAsBC,WAAtB,CAAkCH,EAA7C;AACA,UAAMI,QAAQ,GAAG,MAAMR,KAAK,CAACS,IAAN,CAAW,wCAAX,EAAoD;AACvEL,MAAAA;AADuE,KAApD,CAAvB;AAGA,QAAIM,MAAM,GAAGC,cAAc,CAACH,QAAQ,CAACI,IAAT,CAAcJ,QAAf,CAA3B;AACDT,IAAAA,KAAK,CAACc,QAAN,CAAeX,UAAU,CAACM,QAAQ,CAACI,IAAT,CAAcJ,QAAf,EAAwBE,MAAxB,CAAzB;AACCZ,IAAAA,kBAAkB,CAAC,SAAD,EAAWU,QAAQ,CAACI,IAAT,CAAcJ,QAAzB,CAAlB;AACAV,IAAAA,kBAAkB,CAAC,QAAD,EAAUY,MAAV,CAAlB;AAEH,GAVD,CAUE,OAAOI,CAAP,EAAU;AACRC,IAAAA,OAAO,CAACC,GAAR,CAAYF,CAAC,CAACN,QAAd;AACH;AAEJ,CAhBM;;AAkBP,SAASG,cAAT,CAAwBM,OAAxB,EAAiC;AAC7B,QAAMC,MAAM,GAAGnB,KAAK,CAACM,QAAN,GAAiBC,IAAjB,CAAsBF,EAArC;AACA,MAAIM,MAAM,GAAG;AACTO,IAAAA,OAAO,EAAC,CADC;AAETE,IAAAA,OAAO,EAAE,CAFA;AAGTC,IAAAA,SAAS,EAAE,CAHF;AAITC,IAAAA,KAAK,EAAE;AAJE,GAAb;AAOAJ,EAAAA,OAAO,CAACK,OAAR,CAAiBC,IAAD,IAAQ;AACpB,QAAIA,IAAI,CAACL,MAAL,KAAcA,MAAlB,EAAyB;AACrB,cAAQK,IAAI,CAACC,IAAb;AACI,aAAK,SAAL;AACId,UAAAA,MAAM,CAACO,OAAP;AACA;;AACJ,aAAK,SAAL;AACIP,UAAAA,MAAM,CAACS,OAAP;AACA;;AACJ,aAAK,WAAL;AACIT,UAAAA,MAAM,CAACU,SAAP;AACA;;AACJ,aAAK,OAAL;AACIV,UAAAA,MAAM,CAACW,KAAP;AACA;AAZR;AAcH;AACJ,GAjBD;AAmBA,SAAOX,MAAP;AAEH;;AAED,OAAO,MAAMe,OAAO,GAAG,MAAI;AACvB,MAAIR,OAAO,GAAGlB,KAAK,CAACM,QAAN,GAAiBqB,GAAjB,CAAqBT,OAAnC;AACA,MAAIA,OAAO,CAACU,MAAR,KAAmB,CAAvB,EAA0B5B,KAAK,CAACc,QAAN,CAAeZ,cAAc,EAA7B;AAC7B,CAHM","sourcesContent":["import React from \"react\";\r\nimport saveToLocalStorage, {store} from \"../store\";\r\nimport axios from \"axios\";\r\nimport {refreshHistory, setHistory} from \"../reducers/appReducer\";\r\n\r\n\r\nexport const  startHistory = async () =>{\r\n\r\n    try {\r\n        const id = store.getState().user.currentUser.id;\r\n        const response = await axios.post('http://localhost:5000/history/response',{\r\n            id\r\n        });\r\n        let amount = counterQuizzes(response.data.response);\r\n       store.dispatch(setHistory(response.data.response,amount));\r\n        saveToLocalStorage('history',response.data.response);\r\n        saveToLocalStorage('amount',amount);\r\n\r\n    } catch (e) {\r\n        console.log(e.response);\r\n    }\r\n\r\n}\r\n\r\nfunction counterQuizzes(history) {\r\n    const userId = store.getState().user.id;\r\n    let amount = {\r\n        history:0,\r\n        biology: 0,\r\n        geography: 0,\r\n        mixed: 0\r\n    };\r\n\r\n    history.forEach((item)=>{\r\n        if (item.userId===userId){\r\n            switch (item.kind) {\r\n                case 'history':\r\n                    amount.history++\r\n                    break;\r\n                case 'biology':\r\n                    amount.biology++\r\n                    break;\r\n                case 'geography':\r\n                    amount.geography++\r\n                    break;\r\n                case 'mixed':\r\n                    amount.mixed++\r\n                    break;\r\n            }\r\n        }\r\n    })\r\n\r\n    return amount;\r\n\r\n}\r\n\r\nexport const refresh = ()=>{\r\n    let history = store.getState().app.history;\r\n    if (history.length === 0) store.dispatch(refreshHistory());\r\n}"]},"metadata":{},"sourceType":"module"}